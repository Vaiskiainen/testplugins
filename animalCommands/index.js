(function(M,te,v,d,x,t,ae,h,S){"use strict";const ne=function(e){return e?/\.(png|jpe?g|gif|webp|bmp|tiff|avif)$/i.test(e):!1},E=function(e){return{url:typeof e?.image=="string"?e.image:typeof e?.url=="string"?e.url:null}},ie=[{id:"animal-dog",name:"dog",displayName:"commands.dog.name",description:"commands.dog.description",defaultApiId:"dog-ceo",apis:[{id:"dog-ceo",name:"apis.dog-ceo.name",description:"apis.dog-ceo.description",endpoint:"https://dog.ceo/api/breeds/image/random",parse:function(e){return{url:typeof e?.message=="string"?e.message:null}}},{id:"random-dog",name:"apis.random-dog.name",description:"apis.random-dog.description",endpoint:"https://random.dog/woof.json",parse:function(e){const a=typeof e?.url=="string"?e.url:null;return{url:ne(a)?a:null}}}]},{id:"animal-cat",name:"cat",displayName:"commands.cat.name",description:"commands.cat.description",defaultApiId:"thecatapi",apis:[{id:"thecatapi",name:"apis.thecatapi.name",description:"apis.thecatapi.description",endpoint:"https://api.thecatapi.com/v1/images/search",parse:function(e){return{url:Array.isArray(e)&&e[0]?.url?e[0].url:null}}},{id:"cataas",name:"apis.cataas.name",description:"apis.cataas.description",endpoint:"https://cataas.com/cat?json=true",parse:function(e){const a=typeof e?.url=="string"?e.url:null;return a?{url:a.startsWith("http")?a:`https://cataas.com${a}`}:{url:null}}}]},{id:"animal-fox",name:"fox",displayName:"commands.fox.name",description:"commands.fox.description",defaultApiId:"randomfox",apis:[{id:"randomfox",name:"apis.randomfox.name",description:"apis.randomfox.description",endpoint:"https://randomfox.ca/floof/",parse:function(e){return{url:typeof e?.image=="string"?e.image:null}}},{id:"some-random-api",name:"apis.some-random-api.name",description:"apis.some-random-api.description",endpoint:"https://some-random-api.com/animal/fox",parse:function(e){return{url:typeof e?.image=="string"?e.image:null,caption:typeof e?.fact=="string"?e.fact:null}}}]},{id:"animal-duck",name:"duck",displayName:"commands.duck.name",description:"commands.duck.description",defaultApiId:"random-duck-v2",apis:[{id:"random-duck-v2",name:"apis.random-duck-v2.name",description:"apis.random-duck-v2.description",endpoint:"https://random-d.uk/api/v2/random",parse:function(e){return{url:typeof e?.url=="string"?e.url:null}}},{id:"random-duck-v1",name:"apis.random-duck-v1.name",description:"apis.random-duck-v1.description",endpoint:"https://random-d.uk/api/random",parse:function(e){return{url:typeof e?.url=="string"?e.url:null}}}]},{id:"animal-shiba",name:"shiba",displayName:"commands.shiba.name",description:"commands.shiba.description",defaultApiId:"shibe-online",apis:[{id:"shibe-online",name:"apis.shibe-online.name",description:"apis.shibe-online.description",endpoint:"https://shibe.online/api/shibes?count=1&urls=true&httpsUrls=true",parse:function(e){return{url:Array.isArray(e)&&typeof e[0]=="string"?e[0]:null}}},{id:"dog-ceo-shiba",name:"apis.dog-ceo-shiba.name",description:"apis.dog-ceo-shiba.description",endpoint:"https://dog.ceo/api/breed/shiba/images/random",parse:function(e){return{url:typeof e?.message=="string"?e.message:null}}}]},{id:"animal-horse",name:"horse",displayName:"commands.horse.name",description:"commands.horse.description",defaultApiId:"animals-maxz-horse",apis:[{id:"animals-maxz-horse",name:"apis.animals-maxz.name",description:"apis.animals-maxz.description",endpoint:"https://animals.maxz.dev/api/horse/random",parse:E}]},{id:"animal-deer",name:"deer",displayName:"commands.deer.name",description:"commands.deer.description",defaultApiId:"animals-maxz-deer",apis:[{id:"animals-maxz-deer",name:"apis.animals-maxz.name",description:"apis.animals-maxz.description",endpoint:"https://animals.maxz.dev/api/deer/random",parse:E}]},{id:"animal-otter",name:"otter",displayName:"commands.otter.name",description:"commands.otter.description",defaultApiId:"tinyfox-otter",apis:[{id:"tinyfox-otter",name:"apis.tinyfox.name",description:"apis.tinyfox.description",endpoint:"https://api.tinyfox.dev/img.json?animal=ott",parse:function(e){return{url:typeof e?.url=="string"?e.url:typeof e?.image=="string"?e.image:typeof e?.link=="string"?e.link:null}}}]},{id:"animal-bird",name:"bird",displayName:"commands.bird.name",description:"commands.bird.description",defaultApiId:"animals-maxz-bird",apis:[{id:"animals-maxz-bird",name:"apis.animals-maxz.name",description:"apis.animals-maxz.description",endpoint:"https://animals.maxz.dev/api/bird/random",parse:E}]},{id:"animal-turtle",name:"turtle",displayName:"commands.turtle.name",description:"commands.turtle.description",defaultApiId:"animals-maxz-turtle",apis:[{id:"animals-maxz-turtle",name:"apis.animals-maxz.name",description:"apis.animals-maxz.description",endpoint:"https://animals.maxz.dev/api/turtle/random",parse:E}]},{id:"animal-sheep",name:"sheep",displayName:"commands.sheep.name",description:"commands.sheep.description",defaultApiId:"animals-maxz-sheep",apis:[{id:"animals-maxz-sheep",name:"apis.animals-maxz.name",description:"apis.animals-maxz.description",endpoint:"https://animals.maxz.dev/api/sheep/random",parse:E}]},{id:"animal-capybara",name:"capybara",displayName:"commands.capybara.name",description:"commands.capybara.description",defaultApiId:"capy-lol",apis:[{id:"capy-lol",name:"apis.capy-lol.name",description:"apis.capy-lol.description",endpoint:"https://api.capy.lol/v1/capybara?json=true",parse:function(e){return{url:typeof e?.url=="string"?e.url:typeof e?.image=="string"?e.image:typeof e?.link=="string"?e.link:null}}},{id:"animals-maxz-capybara",name:"apis.animals-maxz.name",description:"apis.animals-maxz.description",endpoint:"https://animals.maxz.dev/api/capybara/random",parse:E}]},{id:"animal-dinosaur",name:"dinosaur",displayName:"commands.dinosaur.name",description:"commands.dinosaur.description",defaultApiId:"commons-triceratops",isSecret:!0,apis:[{id:"commons-triceratops",name:"apis.commons-triceratops.name",description:"apis.commons-triceratops.description",directUrl:"https://static01.nyt.com/images/2025/06/09/multimedia/09HS-tb-dinosaur-01-fvzp/09HS-tb-dinosaur-01-fvzp-videoSixteenByNine3000.jpg"}]}],se=function(e){const a=e?.hiddenSettings;return Boolean(a?.enabled)&&a?.visible!==!1},N=function(e){return ie.filter(function(a){return!a.isSecret||se(e)})},z=function(e){e.apiChoice??={};for(const a of N(e)){const n=e.apiChoice[a.id];a.apis.some(function(i){return i.id===n})||(e.apiChoice[a.id]=a.defaultApiId||a.apis[0]?.id)}},U=function(e){e.commandEnabled??={};for(const a of N(e))typeof e.commandEnabled[a.id]!="boolean"&&(e.commandEnabled[a.id]=!0)},D=function(e,a){return e?.commandEnabled?.[a.id]!==!1},H=function(e,a){const n=e?.apiChoice?.[a.id];return a.apis.find(function(i){return i.id===n})||a.apis[0]};var re={dog:{name:"dog",description:"Random dog photo"},cat:{name:"cat",description:"Random cat photo"},fox:{name:"fox",description:"Random fox photo"},duck:{name:"duck",description:"Random duck photo"},shiba:{name:"shiba",description:"Random shiba photo"},horse:{name:"horse",description:"Random horse photo"},deer:{name:"deer",description:"Random deer photo"},otter:{name:"otter",description:"Random otter photo"},bird:{name:"bird",description:"Random bird photo"},turtle:{name:"turtle",description:"Random turtle photo"},sheep:{name:"sheep",description:"Random sheep photo"},capybara:{name:"capybara",description:"Random capybara photo"},dinosaur:{name:"dinosaur",description:"Secret dino \u2014 unlocked via hidden settings"}},oe={"dog-ceo":{name:"Dog CEO",description:"dog.ceo API"},"random-dog":{name:"Random Dog",description:"random.dog (filters non-images)"},thecatapi:{name:"The Cat API",description:"thecatapi.com"},cataas:{name:"Cataas",description:"cataas.com"},randomfox:{name:"RandomFox",description:"randomfox.ca"},"some-random-api":{name:"Some Random API",description:"some-random-api.com (includes fact)"},"random-duck-v2":{name:"Random-d.uk v2",description:"random-d.uk v2 API"},"random-duck-v1":{name:"Random-d.uk v1",description:"random-d.uk v1 API"},"shibe-online":{name:"Shibe.online",description:"shibe.online API"},"dog-ceo-shiba":{name:"Dog CEO (Shiba)",description:"dog.ceo shiba endpoint"},"animals-maxz":{name:"Animals Maxz",description:"animals.maxz.dev"},tinyfox:{name:"Tinyfox",description:"api.tinyfox.dev (ott)"},"capy-lol":{name:"Capy.lol",description:"api.capy.lol"},"commons-triceratops":{name:"Wikimedia Commons (CC0)",description:"A cool dino :3"}},ce={header:{title:"Commands",subtitle:"Cool animal images with slash commands"},groups:{animals:"Animals",note:"Note",choose_api:"Choose API",navigation:"Navigation"},items:{api_label:"API: {{apiName}}",note_text:'Found a bug or want an animal added? DM "@vaiskiainen."',selected_api:"Selected \xB7 {{apiDescription}}",back_to_animals:"Back to animals"},errors:{failed_ui:"Failed to load native settings UI",update_vendetta:"Update your Revenge/Vendetta build and try again."}},de={command_disabled:"That command is disabled in settings.",api_misconfigured:"This API is not configured correctly.",no_image:"API returned no image. Try another source.",fetch_failed:"Failed to fetch animal image.",hidden_settings_unlocked:"Hidden settings unlocked!",hidden_settings_status:"Hidden settings {{status}}"},le={status:{visible:"visible",hidden:"hidden"}},pe={commands:re,apis:oe,settings:ce,toasts:de,ui:le};const X={en:pe},ue=function(e,a){const n=((typeof t.i18n?.getLocale=="function"?t.i18n.getLocale():"en-US")||"en-US").replace("_","-").split("-")[0].toLowerCase(),i=function(u){if(!u)return;const p=u.default||u;return e.split(".").reduce(function(m,c){return m?.[c]},p)};let s=i(X[n]);return typeof s!="string"&&n!=="en"&&(s=i(X.en)),typeof s!="string"?e:me(s,a)},me=function(e,a){if(!a)return e;let n=e;for(const[i,s]of Object.entries(a))n=n.replace(new RegExp(`{{${i}}}`,"g"),s);return n};var r={t:ue};function fe(){const[e,a]=t.React.useState(0),[n,i]=t.React.useState(null),[s,u]=t.React.useState(null),[p,m]=t.React.useState(!1),c=v.findByProps("getUser","getCurrentUser")?.getCurrentUser?.(),{getUserAvatarURL:_}=v.findByProps("getUserAvatarURL")||{},{getDefaultAvatarURL:I}=v.findByProps("getDefaultAvatarURL")||{},g=t.stylesheet.createThemedStyleSheet({container:{flexDirection:"row",alignItems:"center",paddingVertical:24,paddingHorizontal:16,width:"100%",justifyContent:"center"},leftSection:{flexDirection:"row",alignItems:"center",flex:1,gap:20,maxWidth:500},avatarContainer:{position:"relative",width:96,height:96,justifyContent:"center",alignItems:"center"},avatarWrapper:{width:96,height:96,borderRadius:24,backgroundColor:h.semanticColors.BACKGROUND_SECONDARY,justifyContent:"center",alignItems:"center",overflow:"hidden",borderWidth:2,borderColor:h.semanticColors.BACKGROUND_TERTIARY},avatar:{width:92,height:92,borderRadius:22},textContainer:{flex:1,marginLeft:4,justifyContent:"center"},title:{fontSize:22,fontWeight:"700",color:h.semanticColors.TEXT_DEFAULT},subtitle:{marginTop:4,fontSize:14,fontWeight:"600",color:h.semanticColors.TEXT_MUTED},animatedIndicator:{position:"absolute",top:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.7)",borderRadius:10,width:20,height:20,justifyContent:"center",alignItems:"center",zIndex:1},gifText:{color:"#FFFFFF",fontSize:10,fontWeight:"bold"},avatarPlaceholder:{width:48,height:48,tintColor:h.semanticColors.INTERACTIVE_NORMAL}});t.React.useEffect(function(){if(c){let y,b=!1;const o=c.avatar?.startsWith("a_");if(_&&c.avatar)y=_(c,o),b=o;else if(I)y=I(c);else if(c.avatar){const l=c.avatar.startsWith("a_");y=`https://cdn.discordapp.com/avatars/${c.id}/${c.avatar}.${l?"gif":"png"}?size=256`,b=l}else y=`https://cdn.discordapp.com/embed/avatars/${c.discriminator?parseInt(c.discriminator)%5:(parseInt(c.id)>>22)%6}.png`;u(y),m(b)}},[c]);const O=function(){if(d.storage.hiddenSettings?.enabled){d.storage.hiddenSettings.visible=!d.storage.hiddenSettings.visible,x.showToast(r.t("toasts.hidden_settings_status",{status:d.storage.hiddenSettings.visible?r.t("ui.status.visible"):r.t("ui.status.hidden")}),S.getAssetIDByName("SettingsIcon"));const l=globalThis.__animalCommandsRefreshSettings;typeof l=="function"&&l();return}n&&clearTimeout(n);const y=setTimeout(function(){a(0)},1e3);i(y);const b=e+1;if(a(b),b<10)return;x.showToast(r.t("toasts.hidden_settings_unlocked"),S.getAssetIDByName("CheckmarkIcon")),d.storage.hiddenSettings={...d.storage.hiddenSettings,enabled:!0,visible:!0};const o=globalThis.__animalCommandsRefreshSettings;typeof o=="function"&&o(),a(0)};return t.React.createElement(t.ReactNative.View,{style:g.container},t.React.createElement(t.ReactNative.View,{style:g.leftSection},t.React.createElement(t.ReactNative.Pressable,{style:g.avatarContainer,onPress:O},t.React.createElement(t.ReactNative.View,{style:g.avatarWrapper},s?t.React.createElement(t.React.Fragment,null,t.React.createElement(t.ReactNative.Image,{source:{uri:s},style:g.avatar,resizeMode:"cover"}),p&&t.React.createElement(t.ReactNative.View,{style:g.animatedIndicator},t.React.createElement(t.ReactNative.Text,{style:g.gifText},"GIF"))):t.React.createElement(t.ReactNative.Image,{source:S.getAssetIDByName("ic_account_circle_24px"),style:g.avatarPlaceholder}))),t.React.createElement(t.ReactNative.View,{style:g.textContainer},t.React.createElement(t.ReactNative.Text,{style:g.title},r.t("settings.header.title")),t.React.createElement(t.ReactNative.Text,{style:g.subtitle},r.t("settings.header.subtitle")))))}function T({title:e,icon:a,children:n,padding:i=!1}){const s=t.stylesheet.createThemedStyleSheet({main:{backgroundColor:h.rawColors.PLUM_18,borderColor:h.semanticColors.CARD_BACKGROUND_DEFAULT,borderWidth:1,borderRadius:16,overflow:"hidden",flex:1,maxWidth:"100%"},titleContainer:{marginBottom:8,marginHorizontal:16,marginTop:8,gap:4,flexDirection:"row",alignItems:"center"},icon:{width:16,height:16,marginTop:1.5,tintColor:h.semanticColors.TEXT_MUTED},titleText:{fontSize:14,fontWeight:"600",color:h.semanticColors.TEXT_MUTED},wrapper:{marginHorizontal:16,marginTop:16,maxWidth:"100%"}});return t.React.createElement(t.ReactNative.View,{style:s.wrapper},e&&t.React.createElement(t.ReactNative.View,{style:s.titleContainer},a&&t.React.createElement(t.ReactNative.Image,{style:s.icon,source:a,resizeMode:"cover"}),t.React.createElement(t.ReactNative.Text,{style:s.titleText},e.toUpperCase())),t.React.createElement(t.ReactNative.View,{style:s.main},i?t.React.createElement(t.ReactNative.View,{style:{paddingHorizontal:16,paddingVertical:16}},n):n))}const{ScrollView:ge,View:k,Text:P,Animated:F,Easing:G}=t.ReactNative,he=ae.Forms||v.findByProps("FormSection","FormRow","FormText","FormRadioRow","FormCheckRow")||{},{FormRow:w,FormText:ye,FormRadioRow:Re,FormCheckRow:be}=he,$=ye??P,K=Re??be??null,A=w?.Icon,R=function(...e){for(const a of e){const n=S.getAssetIDByName(a);if(n)return n}},B=R("ic_image","ic_image_24px","ic_photo_24px","ic_gallery_24px","ic_add_photo_24px"),L=R("ic_arrow_right","ic_chevron_right_24px","ic_arrow_forward_24px"),V=R("back-icon","ic_arrow_back_24px","ic_chevron_left_24px"),j=function(){if(B)return A?t.React.createElement(A,{source:B}):t.React.createElement(t.ReactNative.Image,{source:B,style:{width:20,height:20,tintColor:h.semanticColors.TEXT_MUTED}})},ve=function(){if(L)return A?t.React.createElement(A,{source:L}):t.React.createElement(t.ReactNative.Image,{source:L,style:{width:20,height:20,tintColor:h.semanticColors.TEXT_MUTED}})},_e=function(){if(V)return A?t.React.createElement(A,{source:V}):t.React.createElement(t.ReactNative.Image,{source:V,style:{width:20,height:20,tintColor:h.semanticColors.TEXT_MUTED}})};function xe(){t.React.useEffect(function(){z(d.storage),U(d.storage)},[]);const[e,a]=t.React.useState(null),[n,i]=t.React.useState(null),[s,u]=t.React.useState(0),p=t.React.useRef(new F.Value(0)).current,m=t.React.useRef(null),[,c]=t.React.useReducer(function(o){return o+1},0),_=N(d.storage);t.React.useEffect(function(){return globalThis.__animalCommandsRefreshSettings=function(){z(d.storage),U(d.storage),c();const o=globalThis.__animalCommandsReload;typeof o=="function"&&o()},function(){try{delete globalThis.__animalCommandsRefreshSettings}catch{}}},[]);const I=function(o,l){d.storage.apiChoice={...d.storage.apiChoice??{},[o]:l},c()},g=function(o,l){d.storage.commandEnabled={...d.storage.commandEnabled??{},[o]:l},c();const C=globalThis.__animalCommandsReload;typeof C=="function"&&C()};if(t.React.useEffect(function(){e&&i(e),F.timing(p,{toValue:e?1:0,duration:220,easing:G.out(G.cubic),useNativeDriver:!0}).start(function({finished:o}){o&&!e&&i(null)})},[e,p]),t.React.useEffect(function(){e&&!_.some(function(o){return o.id===e})&&a(null)},[e,_]),t.React.useEffect(function(){try{m.current?.scrollTo?.({y:0,animated:!1})}catch{}},[e]),!w)return t.React.createElement(k,{style:{flex:1,padding:16,justifyContent:"center",alignItems:"center"}},t.React.createElement(P,{style:{fontSize:18,fontWeight:"600",textAlign:"center"}},r.t("settings.errors.failed_ui")),t.React.createElement(P,{style:{marginTop:6,fontSize:15,textAlign:"center"}},r.t("settings.errors.update_vendetta")));const O=function(){return t.React.createElement(t.React.Fragment,null,t.React.createElement(fe,null),t.React.createElement(T,{title:r.t("settings.groups.animals"),icon:R("SendMessageIcon","ic_pets_24px","ic_account_circle_24px")},_.map(function(o){const l=H(d.storage,o),C=D(d.storage,o);return t.React.createElement(w,{key:o.id,label:r.t(o.displayName),subLabel:r.t("settings.items.api_label",{apiName:r.t(l.name)}),leading:j(),trailing:t.React.createElement(t.ReactNative.View,{style:{flexDirection:"row",alignItems:"center"}},t.React.createElement(t.ReactNative.Switch,{value:C,onValueChange:function(f){return g(o.id,f)}}),t.React.createElement(t.ReactNative.View,{style:{marginLeft:6}},ve())),onPress:function(){return a(o.id)}})})),t.React.createElement(T,{title:r.t("settings.groups.note"),icon:R("ic_info_24px","SettingsIcon"),padding:!0},t.React.createElement($,null,r.t("settings.items.note_text"))))},y=function(){const o=n??e,l=_.find(function(f){return f.id===o});if(!l)return null;const C=d.storage.apiChoice?.[l.id]??l.defaultApiId;return t.React.createElement(t.React.Fragment,null,t.React.createElement(T,{title:r.t(l.displayName),icon:R("ic_pets_24px","ic_account_circle_24px"),padding:!0},l.description?t.React.createElement($,null,l.description):null),t.React.createElement(T,{title:"Choose API",icon:R("SettingsIcon","ic_settings_24px")},l.apis.map(function(f){const ee=f.id===C;if(K)return t.React.createElement(K,{key:f.id,label:r.t(f.name),subLabel:r.t(f.description),selected:ee,leading:j(),onPress:function(){return I(l.id,f.id)}});const Ne=ee?r.t("settings.items.selected_api",{apiDescription:r.t(f.description)}):r.t(f.description);return t.React.createElement(w,{key:f.id,label:r.t(f.name),subLabel:Ne,leading:j(),onPress:function(){return I(l.id,f.id)}})})),t.React.createElement(T,{title:r.t("settings.groups.navigation"),icon:R("ic_keyboard_arrow_left_24px","XIcon")},t.React.createElement(w,{label:r.t("settings.items.back_to_animals"),leading:_e(),onPress:function(){return a(null)}})))},b=s>0?p.interpolate({inputRange:[0,1],outputRange:[0,-s]}):0;return t.React.createElement(k,{style:{flex:1},onLayout:function(o){return u(o.nativeEvent.layout.width)}},t.React.createElement(ge,{ref:m,style:{flex:1},scrollEnabled:!0},t.React.createElement(F.View,{style:{flexDirection:"row",width:s>0?s*2:"200%",transform:[{translateX:b}]}},t.React.createElement(k,{style:{width:s||"100%"},pointerEvents:e?"none":"auto"},O()),t.React.createElement(k,{style:{width:s||"100%"},pointerEvents:e?"auto":"none"},y()))))}const Ee={CHAT:1},Ae={BUILT_IN:1},Y=function(...e){return console.warn("[AnimalCommands]",...e)},Q=function(e){return e?.message||String(e)},Ce=function(){const e=globalThis;if(e?.MessageActions&&typeof e.MessageActions=="object")return e.MessageActions;const a=v.findByProps("sendMessage");if(a)return a;const n=v.findByProps("sendMessage","receiveMessage");return n||v.findByProps("createMessage","getMessages")||null},Te=async function(e,a){const n=Ce();if(!n)return{ok:!1};const i={content:a},s=Date.now().toString(),u=[{fn:function(){return n?.sendMessage?.(e,i)},name:"MA.sendMessage(channelId, msgObj)"},{fn:function(){return n?.sendMessage?.(e,i,!0)},name:"MA.sendMessage(channelId, msgObj, true)"},{fn:function(){return n?.sendMessage?.(e,i,void 0,{nonce:s})},name:"MA.sendMessage(channelId,msg,undefined,{nonce})"},{fn:function(){return n?.createMessage?.(e,i)},name:"MA.createMessage(channelId, msgObj)"},{fn:function(){return n?.createMessage?.(e,a)},name:"MA.createMessage(channelId, content)"},{fn:function(){return n?.createMessage?.(e,i,void 0,{nonce:s})},name:"MA.createMessage(channelId,msg,undefined,{nonce})"},{fn:function(){return n?.sendMessage?.(e,a)},name:"MA.sendMessage(channelId, content)"},{fn:function(){return n?.sendMessage?.(e,a,!0)},name:"MA.sendMessage(channelId, content, true)"},{fn:function(){return n.default?.createMessage?n.default.createMessage(e,i):void 0},name:"MA.default.createMessage"},{fn:function(){return n?.dispatch?n.dispatch({type:"CREATE_MESSAGE",channelId:e,message:i}):void 0},name:"MA.dispatch(CREATE_MESSAGE)"}];for(const p of u)try{const m=p.fn();return m&&typeof m.then=="function"&&await m,{ok:!0,method:p.name}}catch{}return{ok:!1}},we=async function(e,a=8e3){const n=new AbortController,i=setTimeout(function(){return n.abort()},a);try{const s=await fetch(e,{signal:n.signal,headers:{Accept:"application/json"}});if(!s.ok)throw new Error(`HTTP ${s.status}`);return await s.json()}finally{clearTimeout(i)}},Ie=async function(e,a=8e3){const n=new AbortController,i=setTimeout(function(){return n.abort()},a);try{const p=await fetch(e,{method:"HEAD",redirect:"follow",signal:n.signal});if(p.ok&&p.url)return p.url}catch{}finally{clearTimeout(i)}const s=new AbortController,u=setTimeout(function(){return s.abort()},a);try{const p=await fetch(e,{method:"GET",redirect:"follow",signal:s.signal});if(p.ok&&p.url)return p.url}finally{clearTimeout(u)}return e},Z=async function(e,a){const n=e?.channel?.id??e?.channelId??e?.message?.channel_id;return n&&(await Te(n,a)).ok?null:{content:a}};let W=[];const q=function(){for(const e of W)e?.();W=[]},J=function(){q(),W=N(d.storage).filter(function(e){return D(d.storage,e)}).map(function(e){return te.registerCommand({name:e.name,description:r.t(e.description),displayName:r.t(e.displayName),displayDescription:r.t(e.description),options:[],applicationId:"-1",id:e.id,inputType:Ae.BUILT_IN,type:Ee.CHAT,execute:async function(a,n){try{if(!D(d.storage,e))return x.showToast(r.t("toasts.command_disabled")),null;const i=H(d.storage,e);if(i.directUrl){let m=i.directUrl;if(i.cacheBust)try{const c=new URL(m);c.searchParams.set("t",Date.now().toString()),m=c.toString()}catch(c){Y("directUrl:cacheBust failed",e.name,Q(c))}if(i.resolveFinalUrl)try{m=await Ie(m)}catch(c){Y("directUrl:resolveFinalUrl failed",e.name,Q(c))}return await Z(n,m)}if(!i.endpoint||!i.parse)return x.showToast(r.t("toasts.api_misconfigured")),null;const s=await we(i.endpoint),u=i.parse(s);if(!u.url)return x.showToast(r.t("toasts.no_image")),null;const p=`${u.caption?`${u.caption}
`:""}${u.url}`;return await Z(n,p)}catch{return x.showToast(r.t("toasts.fetch_failed")),null}}})})};var Se={onLoad(){z(d.storage),U(d.storage),J(),globalThis.__animalCommandsReload=function(){J()}},onUnload(){q();try{delete globalThis.__animalCommandsReload}catch{}},settings:xe};return M.default=Se,Object.defineProperty(M,"__esModule",{value:!0}),M})({},vendetta.commands,vendetta.metro,vendetta.plugin,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.ui,vendetta.ui.assets);
