(function(u,t,i,f,a){"use strict";const{Text:g,View:C}=t.ReactNative;let c;const y=function(){const e=i.findByProps("getVoiceStates","getVoiceState"),l=i.findByProps("getCurrentUser"),[n,o]=t.React.useState(null),[T,r]=t.React.useState(Date.now());if(t.React.useEffect(function(){if(!e||!l){console.log("VoiceTime: Stores not found");return}const s=function(){const p=l.getCurrentUser();if(!p){console.log("VoiceTime: No user found");return}const h=e.getVoiceState(p.id);console.log("VoiceTime: Voice State Update",h),h?.channelId&&!n&&(console.log("VoiceTime: Joined channel, setting start time"),o(Date.now())),!h?.channelId&&n&&(console.log("VoiceTime: Left channel, clearing start time"),o(null))};return e.addChangeListener(s),s(),function(){return e.removeChangeListener(s)}},[n]),t.React.useEffect(function(){if(!n)return;const s=setInterval(function(){return r(Date.now())},1e3);return function(){return clearInterval(s)}},[n]),!n)return t.React.createElement(g,{style:{color:"red"}}," VT: Idle ");const d=Math.floor((T-n)/1e3),v=Math.floor(d/60),V=d%60;return t.React.createElement(g,{style:{color:"#fff",fontSize:14,marginLeft:8,opacity:.9,backgroundColor:"rgba(0, 0, 0, 0.3)",paddingHorizontal:6,paddingVertical:2,borderRadius:4,overflow:"hidden"}},`${v}:${V<10?"0":""}${V}`)};var m={onLoad(){try{a.showToast("VoiceTime: Plugin loading..."),console.log("VoiceTime: Plugin loading...");const e=i.findByName("ChannelHeader",!1),l=i.findByProps("ChannelHeader"),n=i.findByDisplayName("ChannelHeader",!1),o=function(T,r){if(!r?.props?.children)return r;const d=Array.isArray(r.props.children)?[...r.props.children]:[r.props.children];return d.push(t.React.createElement(C,{style:{flexDirection:"row",alignItems:"center"}},t.React.createElement(y))),r.props.children=d,r};e?.default?(c=f.after("default",e,o),a.showToast("VoiceTime: Patched ChannelHeader (default)")):l?.ChannelHeader?(c=f.after("ChannelHeader",l,o),a.showToast("VoiceTime: Patched ChannelHeader (named)")):n?(c=f.after("default",n,o),a.showToast("VoiceTime: Patched ChannelHeader (display name)")):(console.log("[voiceTime] Could not find ChannelHeader"),a.showToast("VoiceTime: Could not find ChannelHeader"))}catch(e){console.error("VoiceTime Error:",e),a.showToast(`VoiceTime Error: ${e.message}`)}},onUnload(){c&&c()}};return u.default=m,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.metro.common,vendetta.metro,vendetta.patcher,vendetta.ui.toasts);
